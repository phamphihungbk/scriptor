"use strict";
const electron = require("electron");
const node_url = require("node:url");
const node_path = require("node:path");
const node_process = require("node:process");
const ALLOWED_ORIGINS_AND_PERMISSIONS = /* @__PURE__ */ new Map(
  [[new node_url.URL("http://localhost:5173/").origin, /* @__PURE__ */ new Set()]]
);
const ALLOWED_EXTERNAL_ORIGINS = /* @__PURE__ */ new Set(["https://github.com"]);
electron.app.on("web-contents-created", (_, contents) => {
  contents.on("will-navigate", (event, url) => {
    const { origin } = new node_url.URL(url);
    if (ALLOWED_ORIGINS_AND_PERMISSIONS.has(origin)) {
      return;
    }
    event.preventDefault();
    {
      console.warn(`Blocked navigating to disallowed origin: ${origin}`);
    }
  });
  contents.session.setPermissionRequestHandler((webContents, permission, callback) => {
    const { origin } = new node_url.URL(webContents.getURL());
    const permissionGranted = !!ALLOWED_ORIGINS_AND_PERMISSIONS.get(origin)?.has(permission);
    callback(permissionGranted);
    if (!permissionGranted && true) {
      console.warn(`${origin} requested permission for '${permission}', but was rejected.`);
    }
  });
  contents.setWindowOpenHandler(({ url }) => {
    const { origin } = new node_url.URL(url);
    if (ALLOWED_EXTERNAL_ORIGINS.has(origin)) {
      electron.shell.openExternal(url).catch(console.error);
    } else {
      console.warn(`Blocked the opening of a disallowed origin: ${origin}`);
    }
    return { action: "deny" };
  });
  contents.on("will-attach-webview", (event, webPreferences, params) => {
    const { origin } = new node_url.URL(params.src);
    if (!ALLOWED_ORIGINS_AND_PERMISSIONS.has(origin)) {
      {
        console.warn(`A webview tried to attach ${params.src}, but was blocked.`);
      }
      event.preventDefault();
      return;
    }
    delete webPreferences.preload;
    delete webPreferences.preloadURL;
    webPreferences.nodeIntegration = false;
    webPreferences.contextIsolation = true;
  });
});
async function createWindow() {
  const browserWindow = new electron.BrowserWindow({
    show: false,
    // Use the 'ready-to-show' event to show the instantiated BrowserWindow.
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: true,
      sandbox: false,
      // Sandbox disabled because the demo of preload script depend on the Node.js api
      webviewTag: false,
      // The webview tag is not recommended. Consider alternatives like an iframe or Electron's BrowserView. @see https://www.electronjs.org/docs/latest/api/webview-tag#warning
      preload: node_path.join(electron.app.getAppPath(), "packages/preload/dist/index.cjs")
    }
  });
  browserWindow.on("ready-to-show", () => {
    browserWindow?.show();
    {
      browserWindow?.webContents.openDevTools();
    }
  });
  {
    await browserWindow.loadURL("http://localhost:5173/");
  }
  return browserWindow;
}
async function restoreOrCreateWindow() {
  let window = electron.BrowserWindow.getAllWindows().find((w) => !w.isDestroyed());
  if (window === void 0) {
    window = await createWindow();
  }
  if (window.isMinimized()) {
    window.restore();
  }
  window.focus();
}
const isSingleInstance = electron.app.requestSingleInstanceLock();
if (!isSingleInstance) {
  electron.app.quit();
  process.exit(0);
}
electron.app.on("second-instance", restoreOrCreateWindow);
electron.app.disableHardwareAcceleration();
electron.app.on("window-all-closed", () => {
  if (node_process.platform !== "darwin") {
    electron.app.quit();
  }
});
electron.app.on("activate", restoreOrCreateWindow);
electron.app.whenReady().then(restoreOrCreateWindow).catch((e) => console.error("Failed create window:", e));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguY2pzIiwic291cmNlcyI6WyIuLi9zcmMvc2VjdXJpdHktcmVzdHJpY3Rpb25zLnRzIiwiLi4vc3JjL21haW5XaW5kb3cudHMiLCIuLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUge1Nlc3Npb259IGZyb20gJ2VsZWN0cm9uJztcbmltcG9ydCB7YXBwLCBzaGVsbH0gZnJvbSAnZWxlY3Ryb24nO1xuaW1wb3J0IHtVUkx9IGZyb20gJ25vZGU6dXJsJztcblxuLyoqXG4gKiBVbmlvbiBmb3IgYWxsIGV4aXN0aW5nIHBlcm1pc3Npb25zIGluIGVsZWN0cm9uXG4gKi9cbnR5cGUgUGVybWlzc2lvbiA9IFBhcmFtZXRlcnM8XG4gIEV4Y2x1ZGU8UGFyYW1ldGVyczxTZXNzaW9uWydzZXRQZXJtaXNzaW9uUmVxdWVzdEhhbmRsZXInXT5bMF0sIG51bGw+XG4+WzFdO1xuXG4vKipcbiAqIEEgbGlzdCBvZiBvcmlnaW5zIHRoYXQgeW91IGFsbG93IG9wZW4gSU5TSURFIHRoZSBhcHBsaWNhdGlvbiBhbmQgcGVybWlzc2lvbnMgZm9yIHRoZW0uXG4gKlxuICogSW4gZGV2ZWxvcG1lbnQgbW9kZSB5b3UgbmVlZCBhbGxvdyBvcGVuIGBWSVRFX0RFVl9TRVJWRVJfVVJMYC5cbiAqL1xuY29uc3QgQUxMT1dFRF9PUklHSU5TX0FORF9QRVJNSVNTSU9OUyA9IG5ldyBNYXA8c3RyaW5nLCBTZXQ8UGVybWlzc2lvbj4+KFxuICBpbXBvcnQubWV0YS5lbnYuREVWICYmIGltcG9ydC5tZXRhLmVudi5WSVRFX0RFVl9TRVJWRVJfVVJMXG4gICAgPyBbW25ldyBVUkwoaW1wb3J0Lm1ldGEuZW52LlZJVEVfREVWX1NFUlZFUl9VUkwpLm9yaWdpbiwgbmV3IFNldCgpXV1cbiAgICA6IFtdLFxuKTtcblxuLyoqXG4gKiBBIGxpc3Qgb2Ygb3JpZ2lucyB0aGF0IHlvdSBhbGxvdyBvcGVuIElOIEJST1dTRVIuXG4gKiBOYXZpZ2F0aW9uIHRvIHRoZSBvcmlnaW5zIGJlbG93IGlzIG9ubHkgcG9zc2libGUgaWYgdGhlIGxpbmsgb3BlbnMgaW4gYSBuZXcgd2luZG93LlxuICpcbiAqIEBleGFtcGxlXG4gKiA8YVxuICogICB0YXJnZXQ9XCJfYmxhbmtcIlxuICogICBocmVmPVwiaHR0cHM6Ly9naXRodWIuY29tL1wiXG4gKiA+XG4gKi9cbmNvbnN0IEFMTE9XRURfRVhURVJOQUxfT1JJR0lOUyA9IG5ldyBTZXQ8YGh0dHBzOi8vJHtzdHJpbmd9YD4oWydodHRwczovL2dpdGh1Yi5jb20nXSk7XG5cbmFwcC5vbignd2ViLWNvbnRlbnRzLWNyZWF0ZWQnLCAoXywgY29udGVudHMpID0+IHtcbiAgLyoqXG4gICAqIEJsb2NrIG5hdmlnYXRpb24gdG8gb3JpZ2lucyBub3Qgb24gdGhlIGFsbG93bGlzdC5cbiAgICpcbiAgICogTmF2aWdhdGlvbiBleHBsb2l0cyBhcmUgcXVpdGUgY29tbW9uLiBJZiBhbiBhdHRhY2tlciBjYW4gY29udmluY2UgdGhlIGFwcCB0byBuYXZpZ2F0ZSBhd2F5IGZyb20gaXRzIGN1cnJlbnQgcGFnZSxcbiAgICogdGhleSBjYW4gcG9zc2libHkgZm9yY2UgdGhlIGFwcCB0byBvcGVuIGFyYml0cmFyeSB3ZWIgcmVzb3VyY2VzL3dlYnNpdGVzIG9uIHRoZSB3ZWIuXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZWxlY3Ryb25qcy5vcmcvZG9jcy9sYXRlc3QvdHV0b3JpYWwvc2VjdXJpdHkjMTMtZGlzYWJsZS1vci1saW1pdC1uYXZpZ2F0aW9uXG4gICAqL1xuICBjb250ZW50cy5vbignd2lsbC1uYXZpZ2F0ZScsIChldmVudCwgdXJsKSA9PiB7XG4gICAgY29uc3Qge29yaWdpbn0gPSBuZXcgVVJMKHVybCk7XG4gICAgaWYgKEFMTE9XRURfT1JJR0lOU19BTkRfUEVSTUlTU0lPTlMuaGFzKG9yaWdpbikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBQcmV2ZW50IG5hdmlnYXRpb25cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgaWYgKGltcG9ydC5tZXRhLmVudi5ERVYpIHtcbiAgICAgIGNvbnNvbGUud2FybihgQmxvY2tlZCBuYXZpZ2F0aW5nIHRvIGRpc2FsbG93ZWQgb3JpZ2luOiAke29yaWdpbn1gKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBCbG9jayByZXF1ZXN0cyBmb3IgZGlzYWxsb3dlZCBwZXJtaXNzaW9ucy5cbiAgICogQnkgZGVmYXVsdCwgRWxlY3Ryb24gd2lsbCBhdXRvbWF0aWNhbGx5IGFwcHJvdmUgYWxsIHBlcm1pc3Npb24gcmVxdWVzdHMuXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZWxlY3Ryb25qcy5vcmcvZG9jcy9sYXRlc3QvdHV0b3JpYWwvc2VjdXJpdHkjNS1oYW5kbGUtc2Vzc2lvbi1wZXJtaXNzaW9uLXJlcXVlc3RzLWZyb20tcmVtb3RlLWNvbnRlbnRcbiAgICovXG4gIGNvbnRlbnRzLnNlc3Npb24uc2V0UGVybWlzc2lvblJlcXVlc3RIYW5kbGVyKCh3ZWJDb250ZW50cywgcGVybWlzc2lvbiwgY2FsbGJhY2spID0+IHtcbiAgICBjb25zdCB7b3JpZ2lufSA9IG5ldyBVUkwod2ViQ29udGVudHMuZ2V0VVJMKCkpO1xuXG4gICAgY29uc3QgcGVybWlzc2lvbkdyYW50ZWQgPSAhIUFMTE9XRURfT1JJR0lOU19BTkRfUEVSTUlTU0lPTlMuZ2V0KG9yaWdpbik/LmhhcyhwZXJtaXNzaW9uKTtcbiAgICBjYWxsYmFjayhwZXJtaXNzaW9uR3JhbnRlZCk7XG5cbiAgICBpZiAoIXBlcm1pc3Npb25HcmFudGVkICYmIGltcG9ydC5tZXRhLmVudi5ERVYpIHtcbiAgICAgIGNvbnNvbGUud2FybihgJHtvcmlnaW59IHJlcXVlc3RlZCBwZXJtaXNzaW9uIGZvciAnJHtwZXJtaXNzaW9ufScsIGJ1dCB3YXMgcmVqZWN0ZWQuYCk7XG4gICAgfVxuICB9KTtcblxuICAvKipcbiAgICogSHlwZXJsaW5rcyBsZWFkaW5nIHRvIGFsbG93ZWQgc2l0ZXMgYXJlIG9wZW5lZCBpbiB0aGUgZGVmYXVsdCBicm93c2VyLlxuICAgKlxuICAgKiBUaGUgY3JlYXRpb24gb2YgbmV3IGB3ZWJDb250ZW50c2AgaXMgYSBjb21tb24gYXR0YWNrIHZlY3Rvci4gQXR0YWNrZXJzIGF0dGVtcHQgdG8gY29udmluY2UgdGhlIGFwcCB0byBjcmVhdGUgbmV3IHdpbmRvd3MsXG4gICAqIGZyYW1lcywgb3Igb3RoZXIgcmVuZGVyZXIgcHJvY2Vzc2VzIHdpdGggbW9yZSBwcml2aWxlZ2VzIHRoYW4gdGhleSBoYWQgYmVmb3JlOyBvciB3aXRoIHBhZ2VzIG9wZW5lZCB0aGF0IHRoZXkgY291bGRuJ3Qgb3BlbiBiZWZvcmUuXG4gICAqIFlvdSBzaG91bGQgZGVueSBhbnkgdW5leHBlY3RlZCB3aW5kb3cgY3JlYXRpb24uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZWxlY3Ryb25qcy5vcmcvZG9jcy9sYXRlc3QvdHV0b3JpYWwvc2VjdXJpdHkjMTQtZGlzYWJsZS1vci1saW1pdC1jcmVhdGlvbi1vZi1uZXctd2luZG93c1xuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmVsZWN0cm9uanMub3JnL2RvY3MvbGF0ZXN0L3R1dG9yaWFsL3NlY3VyaXR5IzE1LWRvLW5vdC11c2Utb3BlbmV4dGVybmFsLXdpdGgtdW50cnVzdGVkLWNvbnRlbnRcbiAgICovXG4gIGNvbnRlbnRzLnNldFdpbmRvd09wZW5IYW5kbGVyKCh7dXJsfSkgPT4ge1xuICAgIGNvbnN0IHtvcmlnaW59ID0gbmV3IFVSTCh1cmwpO1xuXG4gICAgaWYgKEFMTE9XRURfRVhURVJOQUxfT1JJR0lOUy5oYXMob3JpZ2luIGFzIGBodHRwczovLyR7c3RyaW5nfWApKSB7XG4gICAgICAvLyBPcGVuIHVybCBpbiBkZWZhdWx0IGJyb3dzZXIuXG4gICAgICBzaGVsbC5vcGVuRXh0ZXJuYWwodXJsKS5jYXRjaChjb25zb2xlLmVycm9yKTtcbiAgICB9IGVsc2UgaWYgKGltcG9ydC5tZXRhLmVudi5ERVYpIHtcbiAgICAgIGNvbnNvbGUud2FybihgQmxvY2tlZCB0aGUgb3BlbmluZyBvZiBhIGRpc2FsbG93ZWQgb3JpZ2luOiAke29yaWdpbn1gKTtcbiAgICB9XG5cbiAgICAvLyBQcmV2ZW50IGNyZWF0aW5nIGEgbmV3IHdpbmRvdy5cbiAgICByZXR1cm4ge2FjdGlvbjogJ2RlbnknfTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIFZlcmlmeSB3ZWJ2aWV3IG9wdGlvbnMgYmVmb3JlIGNyZWF0aW9uLlxuICAgKlxuICAgKiBTdHJpcCBhd2F5IHByZWxvYWQgc2NyaXB0cywgZGlzYWJsZSBOb2RlLmpzIGludGVncmF0aW9uLCBhbmQgZW5zdXJlIG9yaWdpbnMgYXJlIG9uIHRoZSBhbGxvd2xpc3QuXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZWxlY3Ryb25qcy5vcmcvZG9jcy9sYXRlc3QvdHV0b3JpYWwvc2VjdXJpdHkjMTItdmVyaWZ5LXdlYnZpZXctb3B0aW9ucy1iZWZvcmUtY3JlYXRpb25cbiAgICovXG4gIGNvbnRlbnRzLm9uKCd3aWxsLWF0dGFjaC13ZWJ2aWV3JywgKGV2ZW50LCB3ZWJQcmVmZXJlbmNlcywgcGFyYW1zKSA9PiB7XG4gICAgY29uc3Qge29yaWdpbn0gPSBuZXcgVVJMKHBhcmFtcy5zcmMpO1xuICAgIGlmICghQUxMT1dFRF9PUklHSU5TX0FORF9QRVJNSVNTSU9OUy5oYXMob3JpZ2luKSkge1xuICAgICAgaWYgKGltcG9ydC5tZXRhLmVudi5ERVYpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBBIHdlYnZpZXcgdHJpZWQgdG8gYXR0YWNoICR7cGFyYW1zLnNyY30sIGJ1dCB3YXMgYmxvY2tlZC5gKTtcbiAgICAgIH1cblxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTdHJpcCBhd2F5IHByZWxvYWQgc2NyaXB0cyBpZiB1bnVzZWQgb3IgdmVyaWZ5IHRoZWlyIGxvY2F0aW9uIGlzIGxlZ2l0aW1hdGUuXG4gICAgZGVsZXRlIHdlYlByZWZlcmVuY2VzLnByZWxvYWQ7XG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvciBgcHJlbG9hZFVSTGAgZXhpc3RzLiAtIEBzZWUgaHR0cHM6Ly93d3cuZWxlY3Ryb25qcy5vcmcvZG9jcy9sYXRlc3QvYXBpL3dlYi1jb250ZW50cyNldmVudC13aWxsLWF0dGFjaC13ZWJ2aWV3XG4gICAgZGVsZXRlIHdlYlByZWZlcmVuY2VzLnByZWxvYWRVUkw7XG5cbiAgICAvLyBEaXNhYmxlIE5vZGUuanMgaW50ZWdyYXRpb25cbiAgICB3ZWJQcmVmZXJlbmNlcy5ub2RlSW50ZWdyYXRpb24gPSBmYWxzZTtcblxuICAgIC8vIEVuYWJsZSBjb250ZXh0SXNvbGF0aW9uXG4gICAgd2ViUHJlZmVyZW5jZXMuY29udGV4dElzb2xhdGlvbiA9IHRydWU7XG4gIH0pO1xufSk7XG4iLCJpbXBvcnQge2FwcCwgQnJvd3NlcldpbmRvd30gZnJvbSAnZWxlY3Ryb24nO1xuaW1wb3J0IHtqb2luLCByZXNvbHZlfSBmcm9tICdub2RlOnBhdGgnO1xuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVXaW5kb3coKSB7XG4gIGNvbnN0IGJyb3dzZXJXaW5kb3cgPSBuZXcgQnJvd3NlcldpbmRvdyh7XG4gICAgc2hvdzogZmFsc2UsIC8vIFVzZSB0aGUgJ3JlYWR5LXRvLXNob3cnIGV2ZW50IHRvIHNob3cgdGhlIGluc3RhbnRpYXRlZCBCcm93c2VyV2luZG93LlxuICAgIHdlYlByZWZlcmVuY2VzOiB7XG4gICAgICBub2RlSW50ZWdyYXRpb246IGZhbHNlLFxuICAgICAgY29udGV4dElzb2xhdGlvbjogdHJ1ZSxcbiAgICAgIHNhbmRib3g6IGZhbHNlLCAvLyBTYW5kYm94IGRpc2FibGVkIGJlY2F1c2UgdGhlIGRlbW8gb2YgcHJlbG9hZCBzY3JpcHQgZGVwZW5kIG9uIHRoZSBOb2RlLmpzIGFwaVxuICAgICAgd2Vidmlld1RhZzogZmFsc2UsIC8vIFRoZSB3ZWJ2aWV3IHRhZyBpcyBub3QgcmVjb21tZW5kZWQuIENvbnNpZGVyIGFsdGVybmF0aXZlcyBsaWtlIGFuIGlmcmFtZSBvciBFbGVjdHJvbidzIEJyb3dzZXJWaWV3LiBAc2VlIGh0dHBzOi8vd3d3LmVsZWN0cm9uanMub3JnL2RvY3MvbGF0ZXN0L2FwaS93ZWJ2aWV3LXRhZyN3YXJuaW5nXG4gICAgICBwcmVsb2FkOiBqb2luKGFwcC5nZXRBcHBQYXRoKCksICdwYWNrYWdlcy9wcmVsb2FkL2Rpc3QvaW5kZXguY2pzJyksXG4gICAgfSxcbiAgfSk7XG5cbiAgLyoqXG4gICAqIElmIHRoZSAnc2hvdycgcHJvcGVydHkgb2YgdGhlIEJyb3dzZXJXaW5kb3cncyBjb25zdHJ1Y3RvciBpcyBvbWl0dGVkIGZyb20gdGhlIGluaXRpYWxpemF0aW9uIG9wdGlvbnMsXG4gICAqIGl0IHRoZW4gZGVmYXVsdHMgdG8gJ3RydWUnLiBUaGlzIGNhbiBjYXVzZSBmbGlja2VyaW5nIGFzIHRoZSB3aW5kb3cgbG9hZHMgdGhlIGh0bWwgY29udGVudCxcbiAgICogYW5kIGl0IGFsc28gaGFzIHNob3cgcHJvYmxlbWF0aWMgYmVoYXZpb3VyIHdpdGggdGhlIGNsb3Npbmcgb2YgdGhlIHdpbmRvdy5cbiAgICogVXNlIGBzaG93OiBmYWxzZWAgYW5kIGxpc3RlbiB0byB0aGUgIGByZWFkeS10by1zaG93YCBldmVudCB0byBzaG93IHRoZSB3aW5kb3cuXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsZWN0cm9uL2VsZWN0cm9uL2lzc3Vlcy8yNTAxMiBmb3IgdGhlIGFmZm9yZCBtZW50aW9uZWQgaXNzdWUuXG4gICAqL1xuICBicm93c2VyV2luZG93Lm9uKCdyZWFkeS10by1zaG93JywgKCkgPT4ge1xuICAgIGJyb3dzZXJXaW5kb3c/LnNob3coKTtcblxuICAgIGlmIChpbXBvcnQubWV0YS5lbnYuREVWKSB7XG4gICAgICBicm93c2VyV2luZG93Py53ZWJDb250ZW50cy5vcGVuRGV2VG9vbHMoKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBMb2FkIHRoZSBtYWluIHBhZ2Ugb2YgdGhlIG1haW4gd2luZG93LlxuICAgKi9cbiAgaWYgKGltcG9ydC5tZXRhLmVudi5ERVYgJiYgaW1wb3J0Lm1ldGEuZW52LlZJVEVfREVWX1NFUlZFUl9VUkwgIT09IHVuZGVmaW5lZCkge1xuICAgIC8qKlxuICAgICAqIExvYWQgZnJvbSB0aGUgVml0ZSBkZXYgc2VydmVyIGZvciBkZXZlbG9wbWVudC5cbiAgICAgKi9cbiAgICBhd2FpdCBicm93c2VyV2luZG93LmxvYWRVUkwoaW1wb3J0Lm1ldGEuZW52LlZJVEVfREVWX1NFUlZFUl9VUkwpO1xuICB9IGVsc2Uge1xuICAgIC8qKlxuICAgICAqIExvYWQgZnJvbSB0aGUgbG9jYWwgZmlsZSBzeXN0ZW0gZm9yIHByb2R1Y3Rpb24gYW5kIHRlc3QuXG4gICAgICpcbiAgICAgKiBVc2UgQnJvd3NlcldpbmRvdy5sb2FkRmlsZSgpIGluc3RlYWQgb2YgQnJvd3NlcldpbmRvdy5sb2FkVVJMKCkgZm9yIFdoYXRXRyBVUkwgQVBJIGxpbWl0YXRpb25zXG4gICAgICogd2hlbiBwYXRoIGNvbnRhaW5zIHNwZWNpYWwgY2hhcmFjdGVycyBsaWtlIGAjYC5cbiAgICAgKiBMZXQgZWxlY3Ryb24gaGFuZGxlIHRoZSBwYXRoIHF1aXJrcy5cbiAgICAgKiBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ub2RlanMvbm9kZS9pc3N1ZXMvMTI2ODJcbiAgICAgKiBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9lbGVjdHJvbi9lbGVjdHJvbi9pc3N1ZXMvNjg2OVxuICAgICAqL1xuICAgIGF3YWl0IGJyb3dzZXJXaW5kb3cubG9hZEZpbGUocmVzb2x2ZShfX2Rpcm5hbWUsICcuLi8uLi9yZW5kZXJlci9kaXN0L2luZGV4Lmh0bWwnKSk7XG4gIH1cblxuICByZXR1cm4gYnJvd3NlcldpbmRvdztcbn1cblxuLyoqXG4gKiBSZXN0b3JlIGFuIGV4aXN0aW5nIEJyb3dzZXJXaW5kb3cgb3IgQ3JlYXRlIGEgbmV3IEJyb3dzZXJXaW5kb3cuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXN0b3JlT3JDcmVhdGVXaW5kb3coKSB7XG4gIGxldCB3aW5kb3cgPSBCcm93c2VyV2luZG93LmdldEFsbFdpbmRvd3MoKS5maW5kKHcgPT4gIXcuaXNEZXN0cm95ZWQoKSk7XG5cbiAgaWYgKHdpbmRvdyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgd2luZG93ID0gYXdhaXQgY3JlYXRlV2luZG93KCk7XG4gIH1cblxuICBpZiAod2luZG93LmlzTWluaW1pemVkKCkpIHtcbiAgICB3aW5kb3cucmVzdG9yZSgpO1xuICB9XG5cbiAgd2luZG93LmZvY3VzKCk7XG59XG4iLCJpbXBvcnQge2FwcH0gZnJvbSAnZWxlY3Ryb24nO1xuaW1wb3J0ICcuL3NlY3VyaXR5LXJlc3RyaWN0aW9ucyc7XG5pbXBvcnQge3Jlc3RvcmVPckNyZWF0ZVdpbmRvd30gZnJvbSAnL0AvbWFpbldpbmRvdyc7XG5pbXBvcnQge3BsYXRmb3JtfSBmcm9tICdub2RlOnByb2Nlc3MnO1xuXG4vKipcbiAqIFByZXZlbnQgZWxlY3Ryb24gZnJvbSBydW5uaW5nIG11bHRpcGxlIGluc3RhbmNlcy5cbiAqL1xuY29uc3QgaXNTaW5nbGVJbnN0YW5jZSA9IGFwcC5yZXF1ZXN0U2luZ2xlSW5zdGFuY2VMb2NrKCk7XG5pZiAoIWlzU2luZ2xlSW5zdGFuY2UpIHtcbiAgYXBwLnF1aXQoKTtcbiAgcHJvY2Vzcy5leGl0KDApO1xufVxuYXBwLm9uKCdzZWNvbmQtaW5zdGFuY2UnLCByZXN0b3JlT3JDcmVhdGVXaW5kb3cpO1xuXG4vKipcbiAqIERpc2FibGUgSGFyZHdhcmUgQWNjZWxlcmF0aW9uIHRvIHNhdmUgbW9yZSBzeXN0ZW0gcmVzb3VyY2VzLlxuICovXG5hcHAuZGlzYWJsZUhhcmR3YXJlQWNjZWxlcmF0aW9uKCk7XG5cbi8qKlxuICogU2hvdXQgZG93biBiYWNrZ3JvdW5kIHByb2Nlc3MgaWYgYWxsIHdpbmRvd3Mgd2FzIGNsb3NlZFxuICovXG5hcHAub24oJ3dpbmRvdy1hbGwtY2xvc2VkJywgKCkgPT4ge1xuICBpZiAocGxhdGZvcm0gIT09ICdkYXJ3aW4nKSB7XG4gICAgYXBwLnF1aXQoKTtcbiAgfVxufSk7XG5cbi8qKlxuICogQHNlZSBodHRwczovL3d3dy5lbGVjdHJvbmpzLm9yZy9kb2NzL2xhdGVzdC9hcGkvYXBwI2V2ZW50LWFjdGl2YXRlLW1hY29zIEV2ZW50OiAnYWN0aXZhdGUnLlxuICovXG5hcHAub24oJ2FjdGl2YXRlJywgcmVzdG9yZU9yQ3JlYXRlV2luZG93KTtcblxuLyoqXG4gKiBDcmVhdGUgdGhlIGFwcGxpY2F0aW9uIHdpbmRvdyB3aGVuIHRoZSBiYWNrZ3JvdW5kIHByb2Nlc3MgaXMgcmVhZHkuXG4gKi9cbmFwcFxuICAud2hlblJlYWR5KClcbiAgLnRoZW4ocmVzdG9yZU9yQ3JlYXRlV2luZG93KVxuICAuY2F0Y2goZSA9PiBjb25zb2xlLmVycm9yKCdGYWlsZWQgY3JlYXRlIHdpbmRvdzonLCBlKSk7XG5cbi8qKlxuICogSW5zdGFsbCBWdWUuanMgb3IgYW55IG90aGVyIGV4dGVuc2lvbiBpbiBkZXZlbG9wbWVudCBtb2RlIG9ubHkuXG4gKiBOb3RlOiBZb3UgbXVzdCBpbnN0YWxsIGBlbGVjdHJvbi1kZXZ0b29scy1pbnN0YWxsZXJgIG1hbnVhbGx5XG4gKi9cbi8vIGlmIChpbXBvcnQubWV0YS5lbnYuREVWKSB7XG4vLyAgIGFwcFxuLy8gICAgIC53aGVuUmVhZHkoKVxuLy8gICAgIC50aGVuKCgpID0+IGltcG9ydCgnZWxlY3Ryb24tZGV2dG9vbHMtaW5zdGFsbGVyJykpXG4vLyAgICAgLnRoZW4obW9kdWxlID0+IHtcbi8vICAgICAgIGNvbnN0IHtkZWZhdWx0OiBpbnN0YWxsRXh0ZW5zaW9uLCBWVUVKUzNfREVWVE9PTFN9ID1cbi8vICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBIb3RmaXggZm9yIGh0dHBzOi8vZ2l0aHViLmNvbS9jYXdhLTkzL3ZpdGUtZWxlY3Ryb24tYnVpbGRlci9pc3N1ZXMvOTE1XG4vLyAgICAgICAgIHR5cGVvZiBtb2R1bGUuZGVmYXVsdCA9PT0gJ2Z1bmN0aW9uJyA/IG1vZHVsZSA6IChtb2R1bGUuZGVmYXVsdCBhcyB0eXBlb2YgbW9kdWxlKTtcbi8vXG4vLyAgICAgICByZXR1cm4gaW5zdGFsbEV4dGVuc2lvbihWVUVKUzNfREVWVE9PTFMsIHtcbi8vICAgICAgICAgbG9hZEV4dGVuc2lvbk9wdGlvbnM6IHtcbi8vICAgICAgICAgICBhbGxvd0ZpbGVBY2Nlc3M6IHRydWUsXG4vLyAgICAgICAgIH0sXG4vLyAgICAgICB9KTtcbi8vICAgICB9KVxuLy8gICAgIC5jYXRjaChlID0+IGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCBpbnN0YWxsIGV4dGVuc2lvbjonLCBlKSk7XG4vLyB9XG5cbi8qKlxuICogQ2hlY2sgZm9yIGFwcCB1cGRhdGVzLCBpbnN0YWxsIGl0IGluIGJhY2tncm91bmQgYW5kIG5vdGlmeSB1c2VyIHRoYXQgbmV3IHZlcnNpb24gd2FzIGluc3RhbGxlZC5cbiAqIE5vIHJlYXNvbiBydW4gdGhpcyBpbiBub24tcHJvZHVjdGlvbiBidWlsZC5cbiAqIEBzZWUgaHR0cHM6Ly93d3cuZWxlY3Ryb24uYnVpbGQvYXV0by11cGRhdGUuaHRtbCNxdWljay1zZXR1cC1ndWlkZVxuICpcbiAqIE5vdGU6IEl0IG1heSB0aHJvdyBcIkVOT0VOVDogbm8gc3VjaCBmaWxlIGFwcC11cGRhdGUueW1sXCJcbiAqIGlmIHlvdSBjb21waWxlIHByb2R1Y3Rpb24gYXBwIHdpdGhvdXQgcHVibGlzaGluZyBpdCB0byBkaXN0cmlidXRpb24gc2VydmVyLlxuICogTGlrZSBgbnBtIHJ1biBjb21waWxlYCBkb2VzLiBJdCdzIG9rIPCfmIVcbiAqL1xuaWYgKGltcG9ydC5tZXRhLmVudi5QUk9EKSB7XG4gIGFwcFxuICAgIC53aGVuUmVhZHkoKVxuICAgIC50aGVuKCgpID0+XG4gICAgICAvKipcbiAgICAgICAqIEhlcmUgd2UgZm9yY2VkIHRvIHVzZSBgcmVxdWlyZWAgc2luY2UgZWxlY3Ryb24gZG9lc24ndCBmdWxseSBzdXBwb3J0IGR5bmFtaWMgaW1wb3J0IGluIGFzYXIgYXJjaGl2ZXNcbiAgICAgICAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsZWN0cm9uL2VsZWN0cm9uL2lzc3Vlcy8zODgyOVxuICAgICAgICogUG90ZW50aWFsbHkgaXQgbWF5IGJlIGZpeGVkIGJ5IHRoaXMgaHR0cHM6Ly9naXRodWIuY29tL2VsZWN0cm9uL2VsZWN0cm9uL3B1bGwvMzc1MzVcbiAgICAgICAqL1xuICAgICAgcmVxdWlyZSgnZWxlY3Ryb24tdXBkYXRlcicpLmF1dG9VcGRhdGVyLmNoZWNrRm9yVXBkYXRlc0FuZE5vdGlmeSgpLFxuICAgIClcbiAgICAuY2F0Y2goZSA9PiBjb25zb2xlLmVycm9yKCdGYWlsZWQgY2hlY2sgYW5kIGluc3RhbGwgdXBkYXRlczonLCBlKSk7XG59XG4iXSwibmFtZXMiOlsiVVJMIiwiYXBwIiwic2hlbGwiLCJCcm93c2VyV2luZG93Iiwiam9pbiIsInBsYXRmb3JtIl0sIm1hcHBpbmdzIjoiOzs7OztBQWdCQSxNQUFNLGtDQUFrQyxvQkFBSTtBQUFBLEVBRXRDLENBQUMsQ0FBQyxJQUFJQSxTQUFBQSxJQUFJLHdCQUFtQyxFQUFFLFFBQVEsb0JBQUksSUFBSyxDQUFBLENBQUM7QUFFdkU7QUFZQSxNQUFNLDJCQUEyQixvQkFBSSxJQUF5QixDQUFDLG9CQUFvQixDQUFDO0FBRXBGQyxTQUFBLElBQUksR0FBRyx3QkFBd0IsQ0FBQyxHQUFHLGFBQWE7QUFTOUMsV0FBUyxHQUFHLGlCQUFpQixDQUFDLE9BQU8sUUFBUTtBQUMzQyxVQUFNLEVBQUMsT0FBVSxJQUFBLElBQUlELGFBQUksR0FBRztBQUN4QixRQUFBLGdDQUFnQyxJQUFJLE1BQU0sR0FBRztBQUMvQztBQUFBLElBQ0Y7QUFHQSxVQUFNLGVBQWU7QUFFSTtBQUNmLGNBQUEsS0FBSyw0Q0FBNEMsTUFBTSxFQUFFO0FBQUEsSUFDbkU7QUFBQSxFQUFBLENBQ0Q7QUFRRCxXQUFTLFFBQVEsNEJBQTRCLENBQUMsYUFBYSxZQUFZLGFBQWE7QUFDbEYsVUFBTSxFQUFDLE9BQU0sSUFB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
